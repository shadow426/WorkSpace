
## 2.设备类型

![[Pasted image 20250127230030.png]]

主机
	1.只有一个主机
	2.主机才能发起设备通信
	3.主机分配带宽
	4.保证每个设备工作所需要的时序

外设/设备
	实现网络里的用户功能，最多支持连接到主机的127钟设备
	如人机交互，键盘鼠标，如高吞吐量，视频音频设备

集线器
	扩展总线
	最多5个hub的限制，只能连5个还是深度为5
	提供电源


端口指的是USB口？

主机到设备，面向下行
设备到主机，面向上行
![[Pasted image 20250127231044.png]]


## 3.线缆和连接器

主机插    A口    方形
设备插    B口    标准B    miniB    微型B
type-C    两边都是C口    都能插 


## 4.速度分类
鼠标键盘
耳机
U盘、打印机
USB硬盘、显示器（超级速度，需要创建单独的类与usb2.0有很大不同）

![[Pasted image 20250127231757.png]]

## 5.信号

D+D-之间有90Ω差分阻抗（没懂什么意思）

![[Pasted image 20250127232051.png]]

为了保持默认电平
用15kΩ电阻把D+D-拉到地
![[Pasted image 20250127232206.png]]


全速/高速设备插入，拉高D+
低速设备插入，拉高D-
![[Pasted image 20250127232423.png]]
![[Pasted image 20250127232547.png]]


## 6.电源
防止电压跌落，5V和GND之间接大于120uF的电容
为防止浪涌，接入小于10uF的电容，如果接入大于10uF的电容，则需要设置软起动

![[Pasted image 20250128094416.png]]

![[Pasted image 20250128094830.png]]


具体取决于向主机要求的电流
充电器、Type-C可提供更多电流，高于5V的电压
![[Pasted image 20250128094908.png]]

1s窗口内平均值
![[Pasted image 20250128095120.png]]


## 7.全速USB信号


![[Pasted image 20250128095558.png]]


## 10.枚举
USB为了解决以下问题
不支持热插拔需要重启才能正常工作
![[Pasted image 20250128100242.png]]

USB被设置为自描述组件

插到电脑上会告诉电脑自己是谁以及如何工作

下图过程被称为枚举
![[Pasted image 20250128100624.png]]


设备状态

1.连接状态
设备插入进入连接状态
2.通电状态
如果设备已通电，进入通电状态
3.默认状态
设备通电之后向主机发送信号通知其连接
主机看到通知连接的信号时，向设备发送复位信号，将设备转为默认状态
之后的复位信号都会使设备进入复位状态
4.地址状态
复位完成后，为设备分配唯一的地址  0-127之间
地址0保留给刚刚复位但是没有分配地址的设备
一旦给设备一个地址，他将仅响应发送到该特定地址的数据包

在地址模式下，主机开始查询设备所需的所有信息
	主机要求提供设备描述符
	配置描述符
	字符串描述符

如果主机确定支持设备发出set configuration，告诉设备主机将用哪个配置，配置0表示无法连接，其他配置则表明使用哪个配置

5.已配置
如果主机发送的配置不为0，则进入已配置状态
外围系统准备好在主机中使用

任何时间点
主机可以使总线空闲3ms进入挂起状态（低功耗），返回原来状态时候继续原来的状态